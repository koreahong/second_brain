---
title: ë¹„ë™ê¸° ì½”ë“œ ì‘ì„±
created: 2025-11-28
tags: ["reference", "migrated"]
PARA: 
êµ¬ë¶„: []
---

# ë¹„ë™ê¸° ì½”ë“œ ì‘ì„±

## ğŸ“ ë‚´ìš©

## ê°œë…

- ë¹„ë™ê¸°ì²˜ë¦¬ë„ íŠ¸ëœì­ì…˜ê³¼ ë¹„ìŠ·í•˜ê²Œ í•œê°œì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´ ì „ì²´ë¥¼ ì·¨ì†Œí•  ìˆ˜ ìˆê³  ì•„ë‹ˆë©´ ê°œë³„ë¡œ ë”°ë¡œ ê²°ê³¼ê°’ì„ ê°€ì ¸ì˜¤ê²Œ í•  ìˆ˜ ã…£ã…‡ã…†ìŒ

## ëª©ì 

- ë¹„ë™ê¸° ì²˜ë¦¬ì‹œ ì—ëŸ¬ê´€ë¦¬ë¥¼ í•˜ê¸° ìœ„í•¨

## ì„œì¹­ë‚´ìš©

ë¹„ë™ê¸° ì²˜ë¦¬ ì‹œ í•˜ë‚˜ì˜ ì‘ì—…ì´ ì‹¤íŒ¨í•  ë•Œ ì „ì²´ ë°°ì¹˜ê°€ ì‹¤íŒ¨í•˜ëŠ”ì§€ ì—¬ë¶€ëŠ” process_batch í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ì–´ë–»ê²Œ ë¹„ë™ê¸° ì‘ì—…ì„ ê´€ë¦¬í•˜ëŠ”ì§€ì— ë”°ë¼ ë‹¬ë¼ì§‘ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ Pythonì˜ asyncio ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  ë•Œ, asyncio.gatherë¥¼ í†µí•´ ì—¬ëŸ¬ ë¹„ë™ê¸° ì‘ì—…ì„ ë™ì‹œì— ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ asyncio.gatherì˜ ê¸°ë³¸ ë™ì‘ì€ ì²« ë²ˆì§¸ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ë‚¨ì€ ëª¨ë“  ì‘ì—…ì„ ì·¨ì†Œí•˜ê³  ì˜ˆì™¸ë¥¼ ë˜ì§„ë‹¤ëŠ” ì ì…ë‹ˆë‹¤.

### ê¸°ë³¸ asyncio.gather ë™ì‘

```python
python
ì½”ë“œ ë³µì‚¬
import asyncio

async def task1():
    # ì‘ì—… 1 ìˆ˜í–‰
    pass

async def task2():
    # ì‘ì—… 2 ìˆ˜í–‰
    raise Exception("ì˜¤ë¥˜ ë°œìƒ")

async def process_batch(event):
    tasks = [task1(), task2()]
    results = await asyncio.gather(*tasks)  # ì—¬ê¸°ì„œ task2ê°€ ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¤ë©´


```

ìœ„ ì˜ˆì œì—ì„œ task2ê°€ ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¤ë©´ asyncio.gatherëŠ” ì¦‰ì‹œ ì˜ˆì™¸ë¥¼ ë˜ì§€ê³ , task1ë„ ì·¨ì†Œë©ë‹ˆë‹¤. ë”°ë¼ì„œ ë°°ì¹˜ ë‚´ì˜ ë‹¤ë¥¸ ëª¨ë“  ì‘ì—…ë„ ì‹¤íŒ¨í•˜ê²Œ ë©ë‹ˆë‹¤.

### ì˜ˆì™¸ë¥¼ ê°œë³„ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•

ë§Œì•½ ë°°ì¹˜ ë‚´ì˜ ê° ì‘ì—…ì´ ë…ë¦½ì ìœ¼ë¡œ ì²˜ë¦¬ë˜ê³ , í•˜ë‚˜ì˜ ì‘ì—… ì‹¤íŒ¨ê°€ ì „ì²´ ë°°ì¹˜ ì‹¤íŒ¨ë¡œ ì´ì–´ì§€ì§€ ì•Šë„ë¡ í•˜ë ¤ë©´, ê° ì‘ì—… ë‚´ì—ì„œ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•˜ê±°ë‚˜ asyncio.gatherì˜ return_exceptions íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

### 1. ê° ì‘ì—… ë‚´ì—ì„œ ì˜ˆì™¸ ì²˜ë¦¬

```python
python
ì½”ë“œ ë³µì‚¬
async def safe_task(record):
    try:
        # ì‹¤ì œ ì‘ì—… ìˆ˜í–‰
        await execute_record(record)
    except Exception as e:
        # ì˜ˆì™¸ ë¡œê¹… ë˜ëŠ” ê°œë³„ ì²˜ë¦¬
        print(f"Record ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {e}")
        return None  # ë˜ëŠ” ì ì ˆí•œ ê¸°ë³¸ê°’ ë°˜í™˜

async def process_batch(event):
    tasks = [safe_task(record) for record in event["Records"]]
    results = await asyncio.gather(*tasks)
    # resultsì—ëŠ” ì„±ê³µí•œ ê²°ê³¼ì™€ None(ë˜ëŠ” ê¸°ë³¸ê°’)ì´ í¬í•¨ë¨


```

### 2. asyncio.gatherì—ì„œ return_exceptions=True ì‚¬ìš©

```python
python
ì½”ë“œ ë³µì‚¬
async def execute_record(record):
    # ì‹¤ì œ ì‘ì—… ìˆ˜í–‰
    pass

async def process_batch(event):
    tasks = [execute_record(record) for record in event["Records"]]
    results = await asyncio.gather(*tasks, return_exceptions=True)
    for result in results:
        if isinstance(result, Exception):
            # ì˜ˆì™¸ ë¡œê¹… ë˜ëŠ” ê°œë³„ ì²˜ë¦¬
            print(f"Record ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {result}")
        else:
            # ì„±ê³µí•œ ê²°ê³¼ ì²˜ë¦¬
            pass


```

### ê²°ë¡ 

í˜„ì¬ ë¹„ë™ê¸° ì²˜ë¦¬ ë°©ì‹(asyncio.run(process_batch(event)))ì—ì„œ process_batch í•¨ìˆ˜ê°€ asyncio.gatherë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´, í•˜ë‚˜ì˜ ë ˆì½”ë“œ ì²˜ë¦¬ ì‹¤íŒ¨ê°€ ì „ì²´ ë°°ì¹˜ë¥¼ ì‹¤íŒ¨ì‹œí‚¤ëŠ” ì›ì¸ì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ë°©ì§€í•˜ë ¤ë©´ ê° ë¹„ë™ê¸° ì‘ì—… ë‚´ì—ì„œ ì˜ˆì™¸ë¥¼ ê°œë³„ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê±°ë‚˜ asyncio.gatherì˜ return_exceptions=True ì˜µì…˜ì„ í™œìš©í•˜ì—¬ ì „ì²´ ë°°ì¹˜ê°€ í•˜ë‚˜ì˜ ì‹¤íŒ¨ë¡œ ì¸í•´ ì¤‘ë‹¨ë˜ì§€ ì•Šë„ë¡ í•´ì•¼ í•©ë‹ˆë‹¤.

### ì¶”ê°€ íŒ

- ë¡œê¹…: ê° ì˜ˆì™¸ë¥¼ ë¡œê¹…í•˜ì—¬ ë‚˜ì¤‘ì— ë¬¸ì œë¥¼ ë¶„ì„í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

- ì¬ì‹œë„ ë¡œì§: íŠ¹ì • ì˜ˆì™¸ì— ëŒ€í•´ì„œëŠ” ì¬ì‹œë„ ë¡œì§ì„ ì¶”ê°€í•˜ì—¬ ì¼ì‹œì ì¸ ì˜¤ë¥˜ë¥¼ ê·¹ë³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ë°°ì¹˜ ê²°ê³¼ ì²˜ë¦¬: ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œëœ í›„, ì„±ê³µí•œ ì‘ì—…ê³¼ ì‹¤íŒ¨í•œ ì‘ì—…ì„ êµ¬ë¶„í•˜ì—¬ í›„ì† ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„í•˜ëŠ” ê²ƒì´ ìœ ìš©í•©ë‹ˆë‹¤.

ì´ëŸ¬í•œ ì ‘ê·¼ ë°©ì‹ì„ í†µí•´ í•˜ë‚˜ì˜ ë ˆì½”ë“œ ì‹¤íŒ¨ê°€ ì „ì²´ ë°°ì¹˜ ì²˜ë¦¬ì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šë„ë¡ ì•ˆì •ì ì¸ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì˜ˆì‹œ ì½”ë“œ:

```python
python
ì½”ë“œ ë³µì‚¬
import asyncio
import json

async def execute_record(record):
    # ì˜ˆì‹œ: JSON íŒŒì‹± ë° ì‘ì—… ìˆ˜í–‰
    data = json.loads(record)
    # ì—¬ê¸°ì„œ ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ ì—…ì„œíŠ¸ ë¡œì§ ìˆ˜í–‰
    if data["a"] == 2:
        raise ValueError("ì˜ˆì‹œ ì˜¤ë¥˜")
    return data

async def process_batch(event):
    tasks = [execute_record(record) for record in event["Records"]]
    results = await asyncio.gather(*tasks, return_exceptions=True)
    for i, result in enumerate(results):
        if isinstance(result, Exception):
            print(f"Record {i} ì²˜ë¦¬ ì‹¤íŒ¨: {result}")
        else:
            print(f"Record {i} ì²˜ë¦¬ ì„±ê³µ: {result}")

if __name__ == "__main__":
    event = {
        "Records": [
            '{"mallid": "aivelabs", "target_db": "wahs", "table_name": "test", "schema": "temp", "operation": "execute_upsert", "data": [{"a": 1, "b": 4}]}',
            '{"mallid": "aivelabs", "target_db": "wahs", "table_name": "test", "schema": "temp", "operation": "execute_upsert", "data": [{"a": 2, "b": 3}]}',
        ]
    }
    asyncio.run(process_batch(event))


```

ì¶œë ¥:

```css
css
ì½”ë“œ ë³µì‚¬
Record 0 ì²˜ë¦¬ ì„±ê³µ: {'mallid': 'aivelabs', 'target_db': 'wahs', 'table_name': 'test', 'schema': 'temp', 'operation': 'execute_upsert', 'data': [{'a': 1, 'b': 4}]}
Record 1 ì²˜ë¦¬ ì‹¤íŒ¨: ValueError('ì˜ˆì‹œ ì˜¤ë¥˜')


```

ì´ ì˜ˆì‹œì—ì„œëŠ” ì²« ë²ˆì§¸ ë ˆì½”ë“œëŠ” ì„±ê³µí•˜ê³ , ë‘ ë²ˆì§¸ ë ˆì½”ë“œëŠ” ì˜ë„ì ìœ¼ë¡œ ì˜¤ë¥˜ë¥¼ ë°œìƒì‹œì¼œ ê°œë³„ì ìœ¼ë¡œ ì²˜ë¦¬ë˜ëŠ” ëª¨ìŠµì„ ë³´ì—¬ì¤ë‹ˆë‹¤.

## ğŸ·ï¸ ë¶„ë¥˜

- **PARA**: 
- **êµ¬ë¶„**: ì—†ìŒ

## ğŸ”— ì—°ê²°

**Hub**: [[_HUB_Database]], [[_HUB_Python]], [[_HUB_Analytics]], [[_HUB_DevOps]], [[_HUB_Data_Architecture]]

**í™œìš© í”„ë¡œì íŠ¸**:
- (ì•„ì§ ì—†ìŒ)

**ê´€ë ¨ ë ˆí¼ëŸ°ìŠ¤**:
- (ì•„ì§ ì—†ìŒ)

---

*Notionì—ì„œ ì¬ë§ˆì´ê·¸ë ˆì´ì…˜ë¨ (2025-11-28)*
