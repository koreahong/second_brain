---
title: "2025년 10월 13일"
source: notion
notion_id: 28bc6d43-3b4d-80e2-8dec-ea9e7f83b7da
imported: 2025-11-29
database: 회고록
🔧 대처 방법: "1. Snowflake 저장소 정리
    ◦ Raw, Stage, Mart 계층별 테이블 스캔 후 최근 90일 미사용 테이블 식별
    ◦ 미사용 테이블을 별도 아카이브 DB로 이관 후 삭제
    ◦ 테이블별 last_accessed, row_count, storage_bytes 메타데이터를 DataHub Tag로 반영
2. MFT 성능 최적화
    ◦ Parquet 파일 read 시 pyarrow.dataset 기반으로 selective column load 적용
    ◦ Postgres 쿼리 내 WHERE 조건 필수 검증 로직 추가 (sqlparse 기반)
    ◦ Airflow DAG 레벨에서 쿼리 실행 전 자동 검증 Hook 구현"
🌟 한 줄 요약: ""
✨ 성과 / 개선점: "성과:
• Snowflake 저장소 용량 약 35% 절감
• Airflow DAG 평균 실행 시간 40% 단축
• 비용 예측 가능성 향상 및 쿼리 표준화 기반 마련
개선:
• 자동화 스크립트 실행 시 테이블 삭제 승인 절차가 번거로움
• MFT 쿼리 검증 로직이 일부 복잡한 쿼리(CTE, JOIN)에서는 완벽하지 않음"
🚩 문제 상황: "• Snowflake 저장소에 오래된 테이블, 중복된 마트, 사용되지 않는 스테이징 데이터가 누적되어 저장 비용이 증가하고 관리 효율이 저하됨
• MFT 파이프라인에서 대용량 parquet 파일 로드 및 Postgres 쿼리 성능 저하 발생
    ◦ WHERE 조건 누락으로 풀스캔 빈번
    ◦ 불필요한 컬럼 SELECT로 Snowflake 비용 급증"
역량: ["비용 최적화", "문제해결", "성능개선", "자동화"]
🙌 배운 점: "단순 비용 절감이 아니라 **데이터 생명주기 관리(Lifecycle Management)**의 중요성 인식성능 최적화는 코드 수준이 아니라 데이터 사용 패턴을 기준으로 접근해야 효과적임을 체감"
tags: ["notion-import", "비용 최적화", "문제해결", "자동화", "회고록", "성능개선"]
---

스노우플레이크 저장소 정리 및 관리 최적화

- 테이블 정리 / 불필요 테이블 마이그레이션
---

mft 성능 최적화

1. pqrquet파일 읽기 
1. postgres 사용 where 조건 필수
